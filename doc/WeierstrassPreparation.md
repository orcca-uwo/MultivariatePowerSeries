##ENCODING ISO-8859-1
##PROCEDURE(help,nospec,label="MultivariatePowerSeries/WeierstrassPreparation",versionnew="{XENOMORPH}",versionupdated="{ZONKEY}") MultivariatePowerSeries[WeierstrassPreparation]
##TITLE(halfline="apply the Weierstrass preparation theorem to a univariate polynomial over power series")
##    MultivariatePowerSeries[WeierstrassPreparation]
##ALIAS WeierstrassPreparation, MultivariatePowerSeries:-WeierstrassPreparation, MultivariatePowerSeries
##AUTHOR Ali Asadi masadi4@uwo.ca, Alex Brandt abrandt5@uwo.ca, Marc Moreno Maza moreno@csd.uwo.ca
##
##CALLINGSEQUENCE
##- WeierstrassPreparation('u')
##
##PARAMETERS
##- 'u' : univariate polynomial over power series generated by this package
##
##DESCRIPTION
##- The command ~WeierstrassPreperation(u)~ applies the Weierstrass preparation theorem to
##  the univariate polynomial over power series 'u'. It returns 
##  two univariate polynomials over power series 'p' and 'a', described below.
##- Let 'd' be the smallest integer such that the 'd'-th coefficient of 'u' is a unit.
##  If there is no such coefficient, in other words, if each coefficient of 'u'
##  has a constant coefficient equal to 0, then Maple signals an error.
##- The polynomial 'p' is a Weierstrass polynomial of degree 'd', thus 'p' is monic
##   and every coefficient of 'p', other than the leading one, evaluates
##   to zero at the origin, that is, it belongs to the maximal ideal of the
##   ring of power series. The polynomial 'a' regarded as a
##   power series (even with respect to its main variable)
##   is invertible.  Furthermore, 'u = p * a'.
##- The command ~WeierstrassPreperation(u)~ is based on lazy evaluation techniques.
##  To be precise, this command returns as soon as all coefficients (which are
##  power series) 
##  of the univariate polynomials 'p' and 'a' are initialized, that is, as soon
##  as the generators of all those coefficients have been determined.
##INCLUDE compatibility_warning.mi
##
##INCLUDE assignment_warning.mi
##
##EXAMPLES
##> with(MultivariatePowerSeries):
##- We create a cubic univariate polynomial over power series and apply the Weierstrass preparation
##  theorem to it. The quadratic coefficient of _f_ is the first unit, so _p1_ will be quadratic and
##  _a1_ will be linear.
##> f := UnivariatePolynomialOverPowerSeries([PowerSeries(x), PowerSeries(y), PowerSeries(1),
##  1/PowerSeries(1+x+y)], z);
##<(verification="type") object
##> p1, a1 := WeierstrassPreparation(f);
##>(nohelp) [Degree(p1), Degree(a1)];
##< [2, 1]
##- The terms of _p1_ and _a1_ can only be computed in tandem, so if we update the precision of
##  _p1_, then the precision of _a1_ will also be updated.
##> UpdatePrecision(p1, 5):
##> p1;
##<(verification="type") object
##> a1;
##<(verification="type") object
##- We compute the product of _p1_ and _a1_, and verify that its coefficients are equal at precision 10.
##> h1 := p1 * a1;
##<(verification="type") object
##> ApproximatelyEqual(f, h1, 10);
##< true
##- This cubic univariate polynomial over power series has non-unit constant, linear, and quadratic
##  coefficients of its main variable. Only the cubic coefficient is a unit. Hence if we apply the
##  Weierstrass preparation theorem, _p2_ will be cubic and _a2_ will be independent of _z_.
##> g := UnivariatePolynomialOverPowerSeries([PowerSeries(x), PowerSeries(y), PowerSeries(x), GeometricSeries([x,y])], z);
##<(verification="type") object
##> p2, a2 := WeierstrassPreparation(g);
##>(nohelp) [Degree(p2), Degree(a2)];
##< [3, 0]
##- We multiply the factors together and verify that the coefficients are equal to _g_'s at
##  precision 10.
##> h2 := Multiply(p2, a2);
##<(verification="type") object
##> ApproximatelyEqual(g, h2, 10);
##< true
##
##SEEALSO
##- "PowerSeries"
##- "PuiseuxSeries"
##- "GeometricSeries"
##- "UnivariatePolynomialOverPowerSeries"
##- "Multiply"
##- "Inverse"
##- "HenselFactorize"
##- "ApproximatelyEqual"
##- "IsUnit"
##- "UpdatePrecision"
##
##REFERENCES
##-(lead=indent) Alexander Brandt, Mahsa Kazemi, Marc Moreno Maza.
##  \"Power Series Arithmetic with the BPAS Library.\"
##  **Computer Algebra in Scientific Computing (CASC)**, **Lecture Notes in Computer Science - 12291**, (2020): 108-128.
##-(lead=indent) Mohammadali Asadi, Alexander Brandt, Mahsa Kazemi, Marc Moreno Maza, and Erik Postma. 
## \"Multivariate Power Series in Maple.\" In: Corless R.M., Gerhard J., Kotsireas I.S. (eds) **Maple in Mathematics Education and Research. MC 2020.**
## **Communications in Computer and Information Science (CCIS)**, Vol: **1414** Springer (2021): 48-66.
##
##XREFMAP
##- PowerSeries : Help:MultivariatePowerSeries[PowerSeries]
##- PuiseuxSeries : MultivariatePowerSeries[PuiseuxSeries]
##- GeometricSeries : Help:MultivariatePowerSeries[GeometricSeries]
##- UnivariatePolynomialOverPowerSeries : Help:MultivariatePowerSeries[UnivariatePolynomialOverPowerSeries]
##- Multiply : Help:MultivariatePowerSeries[Multiply]
##- Inverse : Help:MultivariatePowerSeries[Inverse]
##- HenselFactorize : Help:MultivariatePowerSeries[HenselFactorize]
##- ApproximatelyEqual : Help:MultivariatePowerSeries[ApproximatelyEqual]
##- IsUnit : Help:MultivariatePowerSeries[IsUnit]
##- UpdatePrecision : Help:MultivariatePowerSeries[UpdatePrecision]
